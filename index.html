<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MapLibre Mapová Aplikace</title>
    <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
            position: relative;
        }
        
        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
        
        .menu {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            min-width: 220px;
            backdrop-filter: blur(10px);
        }
        
        .menu h3 {
            margin-bottom: 12px;
            color: #333;
            font-size: 14px;
            font-weight: 600;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }
        
        .menu-section {
            margin-bottom: 15px;
        }
        
        .menu-section:last-child {
            margin-bottom: 0;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            margin: 6px 0;
            font-size: 13px;
        }
        
        .menu-item input[type="radio"],
        .menu-item input[type="checkbox"] {
            margin-right: 8px;
            cursor: pointer;
        }
        
        .menu-item label {
            cursor: pointer;
            color: #555;
            user-select: none;
        }
        
        .menu-item input:checked + label {
            color: #333;
            font-weight: 500;
        }
        
        .color-indicator {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            margin-left: auto;
            border: 1px solid #ccc;
        }
        
        @media (max-width: 480px) {
            .menu {
                max-width: calc(100vw - 20px);
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <div class="menu">
        <div class="menu-section">
            <h3>Podkladové mapy</h3>
            <div class="menu-item">
                <input type="radio" id="base1" name="basemap" value="base1" checked>
                <label for="base1">OpenStreetMap</label>
            </div>
            <div class="menu-item">
                <input type="radio" id="base2" name="basemap" value="base2">
                <label for="base2">Základní mapa</label>
            </div>
            <div class="menu-item">
                <input type="radio" id="base3" name="basemap" value="base3">
                <label for="base3">Ortofoto</label>
            </div>
        </div>
        
        <div class="menu-section">
            <h3>Překryvná vrstva</h3>
            <div class="menu-item">
                <input type="checkbox" id="overlay" checked>
                <label for="overlay">Katastrální mapa</label>
            </div>
        </div>
        
        <div class="menu-section">
            <h3>GeoJSON vrstvy</h3>
            <div class="menu-item">
                <input type="checkbox" id="parcely" checked>
                <label for="parcely">Parcely</label>
                <div class="color-indicator" style="background-color: #3388ff;"></div>
            </div>
            <div class="menu-item">
                <input type="checkbox" id="stavby" checked>
                <label for="stavby">Stavby</label>
                <div class="color-indicator" style="background-color: #ff6b35;"></div>
            </div>
            <div class="menu-item">
                <input type="checkbox" id="jednotky" checked>
                <label for="jednotky">Jednotky</label>
                <div class="color-indicator" style="background-color: #4ecdc4;"></div>
            </div>
            <div class="menu-item">
                <input type="checkbox" id="prava_staveb" checked>
                <label for="prava_staveb">Práva staveb</label>
                <div class="color-indicator" style="background-color: #ffe66d;"></div>
            </div>
        </div>
    </div>

    <script>
        // Konfigurace URL - zde doplňte své skutečné URL
        const config = {
            baseMaps: {
                base1: 'https://tile.openstreetmap.org/{z}/{x}/{y}.png',  
                base2: 'https://ags.cuzk.gov.cz/arcgis1/rest/services/ORTOFOTO_WM/MapServer/WMTS/tile/1.0.0/ORTOFOTO_WM/default/GoogleMapsCompatible/{z}/{y}/{x}',        
                base3: 'https://ags.cuzk.gov.cz/arcgis1/rest/services/ZTM_WM/MapServer/WMTS/tile/1.0.0/ZTM_WM/default/GoogleMapsCompatible/{z}/{y}/{x}'
            },
            overlayMap: 'https://services.cuzk.cz/wms/local-km-wms.asp?bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&srs=EPSG:3857&transparent=true&width=256&height=256&layers=hranice_parcel,parcelni_cisla,RST_PK,RST_KMD', // Nahraďte skutečným URL
            geojsonLayers: {
                parcely: './parcely.geojson',    // Cesta k souboru
                stavby: './stavby.geojson',      // Cesta k souboru
                jednotky: './jednotky.geojson',  // Cesta k souboru
                prava_staveb: './prava_staveb.geojson' // Cesta k souboru
            }
        };
        
        // Barvy pro GeoJSON vrstvy
        const colors = {
            parcely: '#3388ff',
            stavby: '#ff6b35',
            jednotky: '#4ecdc4',
            prava_staveb: '#ffe66d'
        };

        // Inicializace mapy
        const map = new maplibregl.Map({
            container: 'map',
            style: {
                version: 8,
                sources: {},
                layers: []
            },
            center: [14.4, 50.08], // Praha - změňte podle potřeby
            zoom: 10
        });

        map.on('load', function() {
            // Přidání podkladových map
            Object.keys(config.baseMaps).forEach(key => {
                map.addSource(key, {
                    type: 'raster',
                    tiles: [config.baseMaps[key]],
                    tileSize: 256
                });
                
                map.addLayer({
                    id: key,
                    type: 'raster',
                    source: key,
                    layout: {
                        visibility: key === 'base1' ? 'visible' : 'none'
                    }
                });
            });

            // Přidání překryvné WMTS vrstvy
            map.addSource('overlay', {
                type: 'raster',
                tiles: [config.overlayMap],
                tileSize: 256
            });
            
            map.addLayer({
                id: 'overlay',
                type: 'raster',
                source: 'overlay',
                layout: {
                    visibility: 'visible'
                }
            });

            // Přidání GeoJSON vrstev
            Object.keys(config.geojsonLayers).forEach(layerId => {
                // Přidání zdroje dat
                map.addSource(layerId, {
                    type: 'geojson',
                    data: config.geojsonLayers[layerId]
                });
                
                // Přidání vrstvy s výplní
                map.addLayer({
                    id: layerId,
                    type: 'fill',
                    source: layerId,
                    paint: {
                        'fill-color': colors[layerId],
                        'fill-opacity': 0.6
                    }
                });
                
                // Přidání obrysu
                map.addLayer({
                    id: layerId + '-outline',
                    type: 'line',
                    source: layerId,
                    paint: {
                        'line-color': colors[layerId],
                        'line-width': 1.5,
                        'line-opacity': 0.8
                    }
                });
            });
        });

        // Obsluha přepínání podkladových map
        document.querySelectorAll('input[name="basemap"]').forEach(radio => {
            radio.addEventListener('change', function() {
                Object.keys(config.baseMaps).forEach(key => {
                    map.setLayoutProperty(key, 'visibility', key === this.value ? 'visible' : 'none');
                });
            });
        });

        // Obsluha překryvné vrstvy
        document.getElementById('overlay').addEventListener('change', function() {
            map.setLayoutProperty('overlay', 'visibility', this.checked ? 'visible' : 'none');
        });

        // Obsluha GeoJSON vrstev
        Object.keys(config.geojsonLayers).forEach(layerId => {
            document.getElementById(layerId).addEventListener('change', function() {
                const visibility = this.checked ? 'visible' : 'none';
                map.setLayoutProperty(layerId, 'visibility', visibility);
                map.setLayoutProperty(layerId + '-outline', 'visibility', visibility);
            });
        });

        // Přidání navigačních ovládacích prvků
        map.addControl(new maplibregl.NavigationControl(), 'top-right');
        map.addControl(new maplibregl.ScaleControl(), 'bottom-right');

        // Obsluha chyb při načítání dat
        map.on('error', function(e) {
            console.warn('Chyba při načítání mapových dat:', e.error);
        });
    </script>
</body>
</html>
